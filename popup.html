<!DOCTYPE html>
<html lang="vi" style="width: 450px; height: auto;">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuickFill Microsoft Forms</title>
    <link rel="stylesheet" href="popup.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üöÄ QuickFill Forms v2.0</h1>
            <p>T·ª± ƒë·ªông ƒëi·ªÅn Microsoft Forms v·ªõi c·∫•u h√¨nh linh ho·∫°t</p>
        </header>

        <div id="status" class="status" style="display: none;"></div>

        <!-- Statistics Section -->
        <div id="statistics" class="statistics" style="display: none;">
            <div class="stats-header">üìä Th·ªëng k√™ Session</div>
            <div class="stats-content">
                <div class="stat-item">
                    <span class="stat-label">Forms ƒë√£ g·ª≠i:</span>
                    <span id="submitCount" class="stat-value">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Th·ªùi gian ch·∫°y:</span>
                    <span id="sessionDuration" class="stat-value">00:00</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Tr·∫°ng th√°i:</span>
                    <span id="runningStatus" class="stat-value status-idle">ƒêang ch·ªù</span>
                </div>
            </div>
        </div>

        <div class="tabs">
            <div class="tab active" onclick="switchTab('basic')">C∆° b·∫£n</div>
            <div class="tab" onclick="switchTab('advanced')">N√¢ng cao</div>
            <div class="tab" onclick="switchTab('questions')">C√¢u h·ªèi</div>
        </div>

        <!-- Basic Settings Tab -->
        <div id="basic-tab" class="tab-content active">
                <div class="section rating-section">
                <h3>‚≠ê C√†i ƒë·∫∑t Likert Scale</h3>
                <div class="rating-config">
                    <label>Ph·∫°m vi ƒëi·ªÉm ƒë√°nh gi√°:</label>
                    <div class="range-inputs">
                        <div class="input-with-label">
                            <label for="ratingMin" class="small-label">T·ªëi thi·ªÉu</label>
                            <input type="number" id="ratingMin" min="1" max="5" value="4">
                        </div>
                        <span class="range-separator">ƒë·∫øn</span>
                        <div class="input-with-label">
                            <label for="ratingMax" class="small-label">T·ªëi ƒëa</label>
                            <input type="number" id="ratingMax" min="1" max="5" value="5">
                        </div>
                    </div>
                    <div class="rating-preview">
                        <span>V√≠ d·ª•: S·∫Ω ch·ªçn ƒëi·ªÉm <strong id="previewRange">4-5</strong> tr√™n thang ƒëi·ªÉm 5</span>
                    </div>
                    
                    <div class="form-group weight-config">
                        <label>‚öñÔ∏è Tr·ªçng s·ªë ph√¢n ph·ªëi ƒëi·ªÉm:</label>
                        <div class="weight-dropdown-container">
                            <button type="button" id="weightToggle" class="weight-toggle-btn">
                                <span id="weightSummary">C·∫•u h√¨nh tr·ªçng s·ªë (4-5)</span>
                                <span class="dropdown-arrow">‚ñº</span>
                            </button>
                            <div id="weightDropdown" class="weight-dropdown hidden">
                                <div class="weight-inputs-container" id="weightInputsContainer">
                                    <!-- Dynamic weight inputs will be generated here -->
                                </div>
                                <div class="weight-explanation">
                                    <small>ÔøΩ S·ªë c√†ng l·ªõn = xu·∫•t hi·ªán c√†ng nhi·ªÅu. T·ªïng kh√¥ng c·∫ßn b·∫±ng 100.</small>
                                    <small>üìä V√≠ d·ª•: 70,25,5 = ƒëi·ªÉm cao 70%, ƒëi·ªÉm trung 25%, ƒëi·ªÉm th·∫•p 5%</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <small>üí° ƒê·ªÉ c√≥ ƒë√°nh gi√° t√≠ch c·ª±c, n√™n ch·ªçn 4-5 cho thang ƒëi·ªÉm 5</small>
                </div>
            </div>            <div class="section">
                <h3>üìã T√πy ch·ªçn c∆° b·∫£n</h3>
                <div class="checkbox-group">
                    <label>
                        <input type="checkbox" id="preferPositiveAnswers" checked>
                        ∆Øu ti√™n c√¢u tr·∫£ l·ªùi t√≠ch c·ª±c
                    </label>
                    <label>
                        <input type="checkbox" id="avoidOther" checked>
                        Tr√°nh l·ª±a ch·ªçn "Kh√°c"
                    </label>
                    <label>
                        <input type="checkbox" id="autoSubmitAnother" checked>
                        T·ª± ƒë·ªông g·ª≠i form m·ªõi sau khi ho√†n th√†nh
                    </label>
                </div>
                
                <div class="form-group">
                    <label>Ng√¥n ng·ªØ vƒÉn b·∫£n:</label>
                    <select id="textLanguage">
                        <option value="vi">Ti·∫øng Vi·ªát</option>
                        <option value="en">English</option>
                    </select>
                </div>
            </div>

            <div class="section">
                <h3>üîÑ C√†i ƒë·∫∑t l·∫∑p l·∫°i</h3>
                <div class="form-group">
                    <label>S·ªë l·∫ßn g·ª≠i t·ªëi ƒëa (0 = kh√¥ng gi·ªõi h·∫°n):</label>
                    <input type="number" id="maxFormSubmissions" min="0" value="0" placeholder="0">
                </div>
                
                <div class="form-group">
                    <label>Th·ªùi gian ch·ªù gi·ªØa c√°c l·∫ßn g·ª≠i (gi√¢y):</label>
                    <input type="number" id="submitDelay" min="1" max="60" value="3" placeholder="3">
                    <small>Th·ªùi gian ch·ªù tr∆∞·ªõc khi b·∫Øt ƒë·∫ßu form m·ªõi</small>
                </div>
            </div>
        </div>

        <!-- Advanced Settings Tab -->
        <div id="advanced-tab" class="tab-content">
            <div class="section">
                <h3>ÔøΩ API Settings (T√πy ch·ªçn)</h3>
                <div class="form-group">
                    <label for="geminiApiKey">Gemini API Key:</label>
                    <input type="password" id="geminiApiKey" placeholder="Nh·∫≠p API key (kh√¥ng b·∫Øt bu·ªôc)">
                    <small>D√πng ƒë·ªÉ t·∫°o c√¢u tr·∫£ l·ªùi text t·ª± nhi√™n h∆°n</small>
                </div>
            </div>

            <div class="section">
                <h3>‚è±Ô∏è C√†i ƒë·∫∑t th·ªùi gian</h3>
                <div class="checkbox-group">
                    <label>
                        <input type="checkbox" id="useRandomDelay" checked>
                        S·ª≠ d·ª•ng ƒë·ªô tr·ªÖ ng·∫´u nhi√™n
                    </label>
                </div>
                
                <div class="delay-config" id="delayConfig">
                    <label>ƒê·ªô tr·ªÖ (ms):</label>
                    <div class="range-inputs">
                        <input type="number" id="delayMin" min="100" max="5000" value="500" placeholder="Min">
                        <span>ƒë·∫øn</span>
                        <input type="number" id="delayMax" min="100" max="5000" value="2000" placeholder="Max">
                    </div>
                    <small>Th·ªùi gian ch·ªù gi·ªØa c√°c thao t√°c</small>
                </div>
            </div>

            <div class="section">
                <h3>üöÄ C√†i ƒë·∫∑t hi·ªáu su·∫•t</h3>
                <div class="form-group">
                    <label>S·ªë l·∫ßn th·ª≠ t·ªëi ƒëa cho m·ªói c√¢u h·ªèi:</label>
                    <input type="number" id="maxRetries" min="1" max="10" value="3" placeholder="3">
                </div>
                
                <div class="form-group">
                    <label>Timeout cho t·ª´ng c√¢u h·ªèi (ms):</label>
                    <input type="number" id="questionTimeout" min="1000" max="10000" value="5000" placeholder="5000">
                </div>
            </div>
        </div>

        <!-- Special Questions Tab -->
        <div id="questions-tab" class="tab-content">
            <div class="section">
                <h3>‚ùì C√¢u tr·∫£ l·ªùi c·ªë ƒë·ªãnh</h3>
                <p>Thi·∫øt l·∫≠p c√¢u tr·∫£ l·ªùi c·ªë ƒë·ªãnh cho c√°c c√¢u h·ªèi c·ª• th·ªÉ</p>
                
                <div id="specialQuestions">
                    <div class="question-item">
                        <input type="text" placeholder="T·ª´ kh√≥a c√¢u h·ªèi (VD: 't√™n', 'tu·ªïi', 'email')" class="question-keyword">
                        <input type="text" placeholder="C√¢u tr·∫£ l·ªùi c·ªë ƒë·ªãnh" class="question-answer">
                        <button class="remove-question" onclick="removeQuestion(this)">‚ùå</button>
                    </div>
                </div>
                
                <button id="addQuestion" class="btn secondary" onclick="addQuestion()">‚ûï Th√™m c√¢u h·ªèi</button>
            </div>

            <div class="section">
                <h3>üéØ Radio Button Preferences</h3>
                <p>T√πy ch·ªânh c√°ch ch·ªçn c√¢u tr·∫£ l·ªùi cho c√¢u h·ªèi radio</p>
                
                <div class="radio-preferences">
                    <label>
                        <input type="radio" name="radioStrategy" value="random" checked>
                        Ch·ªçn ng·∫´u nhi√™n
                    </label>
                    <label>
                        <input type="radio" name="radioStrategy" value="first">
                        Ch·ªçn l·ª±a ch·ªçn ƒë·∫ßu ti√™n (tr√°nh "Kh√°c")
                    </label>
                    <label>
                        <input type="radio" name="radioStrategy" value="middle">
                        ∆Øu ti√™n l·ª±a ch·ªçn ·ªü gi·ªØa
                    </label>
                    <label>
                        <input type="radio" name="radioStrategy" value="positive">
                        ∆Øu ti√™n c√¢u tr·∫£ l·ªùi t√≠ch c·ª±c
                    </label>
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="buttons">
            <button id="fillForm" class="btn primary">üéØ B·∫Øt ƒë·∫ßu ƒëi·ªÅn Form</button>
            <button id="stopFilling" class="btn danger" style="display: none;">‚èπÔ∏è D·ª´ng l·∫°i</button>
            <button id="saveSettings" class="btn secondary">üíæ L∆∞u c√†i ƒë·∫∑t</button>
            <button id="resetSettings" class="btn secondary">üîÑ Reset</button>
            <button id="debugConnection" class="btn secondary" style="font-size: 12px;">üîß Debug Connection</button>
        </div>

        <!-- Instructions -->
        <div class="section">
            <details>
                <summary>üìñ H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng</summary>
                <div class="instructions">
                    <ol>
                        <li><strong>M·ªü Microsoft Forms:</strong> ƒêi·ªÅu h∆∞·ªõng ƒë·∫øn form c·∫ßn ƒëi·ªÅn</li>
                        <li><strong>C·∫•u h√¨nh:</strong> Thi·∫øt l·∫≠p c√°c t√πy ch·ªçn trong extension</li>
                        <li><strong>ƒêi·ªÅn form:</strong> Nh·∫•n "B·∫Øt ƒë·∫ßu ƒëi·ªÅn Form"</li>
                        <li><strong>T·ª± ƒë·ªông:</strong> Extension s·∫Ω t·ª± ƒë·ªông ƒëi·ªÅn v√† g·ª≠i form</li>
                    </ol>
                    <p><strong>üí° M·∫πo:</strong></p>
                    <ul>
                        <li>C√†i ƒë·∫∑t Likert 4-5 ƒë·ªÉ c√≥ ƒëi·ªÉm ƒë√°nh gi√° t√≠ch c·ª±c</li>
                        <li>S·ª≠ d·ª•ng c√¢u tr·∫£ l·ªùi c·ªë ƒë·ªãnh cho c√°c c√¢u h·ªèi quan tr·ªçng</li>
                        <li>B·∫≠t t·ª± ƒë·ªông g·ª≠i form m·ªõi ƒë·ªÉ l·∫∑p l·∫°i process</li>
                    </ul>
                </div>
            </details>
        </div>

        <footer>
            <p>üöÄ <strong>QuickFill v2.0</strong> - T·ª± ƒë·ªông h√≥a Microsoft Forms th√¥ng minh</p>
        </footer>
    </div>

    <script src="popup.js"></script>
</body>
</html>